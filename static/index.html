<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>-</title>
  <style>
    html {
      line-height: 1.3;
      font-family: Georgia, serif;
      font-size: 16px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 70em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.7em;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1.7em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1.7em 0 1.7em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      font-style: italic;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      background-color: #f0f0f0;
      font-size: 85%;
      margin: 0;
      padding: .2em .4em;
    }
    pre {
      padding: 1em;
      background-color: #f0f0f0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin-top: 1.7em;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
    }
    th, td {
      border-bottom: 1px solid lightgray;
      padding: 1em 3em 1em 0;
    }
    header {
      margin-bottom: 6em;
      text-align: center;
    }
    nav a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    .line-spacing-2 div.csl-entry {
      line-height: 2;
    }
    .entry-spacing-1 div.csl-entry {
      margin-bottom: 1em;
    }
    .entry-spacing-2 div.csl-entry {
      margin-bottom: 2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
    div.warning {
      border: 2px solid red;
      padding: 1em;
    }

    div.form {
      display: grid;
      grid-template-columns: auto auto;
    }
    div.item {
      padding-right: 40px;
      min-width: 20em;
    }
    textarea {
      width: 100%;
      height: 15em;
      white-space: pre-wrap;
    }
    .editor {
        border: 1px solid lightgray;
        margin: auto;
        height: 300px;
        width: 95%:
    }
    label {
        font-family: sans-serif;
        font-size: 83%;
        font-weight: bold;
        background-color: #eee;
    }
    button {
        font-family: sans-serif;
        font-size: 83%;
        font-weight: bold;
        border-radius: 12px;
    }

  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>

</head>
<body onload="initialize()">

<div>

<label for="lang">Locale</label>
  <select name="lang" id="lang" onchange="citeproc()">
    <option value="(style default)">(style default)</option>
    <option value="af-ZA">af-ZA</option>
    <option value="ar">ar</option>
    <option value="bg-BG">bg-BG</option>
    <option value="ca-AD">ca-AD</option>
    <option value="cs-CZ">cs-CZ</option>
    <option value="cy-GB">cy-GB</option>
    <option value="da-DK">da-DK</option>
    <option value="de-AT">de-AT</option>
    <option value="de-CH">de-CH</option>
    <option value="de-DE">de-DE</option>
    <option value="el-GR">el-GR</option>
    <option value="en-GB">en-GB</option>
    <option value="en-US">en-US</option>
    <option value="es-CL">es-CL</option>
    <option value="es-ES">es-ES</option>
    <option value="es-MX">es-MX</option>
    <option value="et-EE">et-EE</option>
    <option value="eu">eu</option>
    <option value="fa-IR">fa-IR</option>
    <option value="fi-FI">fi-FI</option>
    <option value="fr-CA">fr-CA</option>
    <option value="fr-FR">fr-FR</option>
    <option value="he-IL">he-IL</option>
    <option value="hr-HR">hr-HR</option>
    <option value="hu-HU">hu-HU</option>
    <option value="id-ID">id-ID</option>
    <option value="is-IS">is-IS</option>
    <option value="it-IT">it-IT</option>
    <option value="ja-JP">ja-JP</option>
    <option value="km-KH">km-KH</option>
    <option value="ko-KR">ko-KR</option>
    <option value="la">la</option>
    <option value="lt-LT">lt-LT</option>
    <option value="lv-LV">lv-LV</option>
    <option value="mn-MN">mn-MN</option>
    <option value="nb-NO">nb-NO</option>
    <option value="nl-NL">nl-NL</option>
    <option value="nn-NO">nn-NO</option>
    <option value="pl-PL">pl-PL</option>
    <option value="pt-BR">pt-BR</option>
    <option value="pt-PT">pt-PT</option>
    <option value="ro-RO">ro-RO</option>
    <option value="ru-RU">ru-RU</option>
    <option value="sk-SK">sk-SK</option>
    <option value="sl-SI">sl-SI</option>
    <option value="sr-RS">sr-RS</option>
    <option value="sv-SE">sv-SE</option>
    <option value="th-TH">th-TH</option>
    <option value="tr-TR">tr-TR</option>
    <option value="uk-UA">uk-UA</option>
    <option value="vi-VN">vi-VN</option>
    <option value="zh-CN">zh-CN</option>
    <option value="zh-TW">zh-TW</option>
  </select>


  <button type="button" onclick="citeproc()">Render</button>

</div>

<div class="form">

  <div class="item">
  </select>
  <label for="style">Style</label>
  <select name="style-name" id="style-name" onchange="loadStyle()">
  </select>
  <br>
  <div id="style" class="editor">
  </div>
  </div>

  <div class="item">
  <label for="abbreviations">Abbreviations<br></label>
  <div id="abbreviations" class="editor">
{ "default": {
    "container-title": {
        "Lloyd's Law Reports": "Lloyd's Rep",
        "Estates Gazette": "EG",
        "Scots Law Times": "SLT"
    }
  }
}
  </div>
  </div>

  <div class="item">
  <label for="references">References<br></label>
  <div id="references" class="editor">[
  {
    "id": "diaz2013",
    "type": "article-journal",
    "title": "What is social construction?",
    "container-title": "European Journal of Philosophy",
    "page": "1-16",
    "URL": "http://onlinelibrary.wiley.com/doi/10.1111/ejop.12033/abstract",
    "DOI": "10.1111/ejop.12033",
    "ISSN": "1468-0378",
    "language": "en",
    "author": [
      {
        "family": "Díaz-León",
        "given": "Esa"
      }
    ],
    "issued": {
      "date-parts": [
        [
          2013,
          5,
          1
        ]
      ]
    },
    "accessed": {
      "date-parts": [
        [
          2015,
          11,
          14
        ]
      ]
    },
    "container-title-short": "Eur J Philos"
  },
  {
    "id": "diaz2015",
    "type": "article-journal",
    "title": "In defence of historical constructivism about races",
    "container-title": "Ergo, an Open Access Journal of Philosophy",
    "volume": "2",
    "URL": "http://hdl.handle.net/2027/spo.12405314.0002.021",
    "DOI": "10.3998/ergo.12405314.0002.021",
    "ISSN": "2330-4014",
    "author": [
      {
        "family": "Díaz-León",
        "given": "Esa"
      }
    ],
    "issued": {
      "date-parts": [
        [
          2015
        ]
      ]
    }
  },
  {
    "id": "diaz2016",
    "type": "article-journal",
    "title": "<i>Woman</i> as a politically significant term: A solution to the puzzle",
    "container-title": "Hypatia",
    "page": "245-258",
    "URL": "http://onlinelibrary.wiley.com.uaccess.univie.ac.at/doi/10.1111/hypa.12234/abstract",
    "DOI": "10.1111/hypa.12234",
    "ISSN": "1527-2001",
    "title-short": "<i>Woman</i> as a Politically Significant Term",
    "language": "en",
    "author": [
      {
        "family": "Díaz-León",
        "given": "Esa"
      }
    ],
    "issued": {
      "date-parts": [
        [
          2016,
          2,
          1
        ]
      ]
    },
    "accessed": {
      "date-parts": [
        [
          2016,
          2,
          18
        ]
      ]
    },
    "container-title-short": "Hypatia"
  },
  {
    "URL": "https://plato.stanford.edu/archives/win2014/entries/conditionals/",
    "author": [
      {
        "family": "Edgington",
        "given": "Dorothy"
      }
    ],
    "container-title": "The Stanford Encyclopedia of Philosophy",
    "edition": "Winter 2014",
    "editor": [
      {
        "family": "Zalta",
        "given": "Edward N."
      }
    ],
    "id": "edgington:conditionals",
    "issued": {
      "date-parts": [
        [
          2014
        ]
      ]
    },
    "publisher": "Metaphysics Research Lab, Stanford University",
    "title": "Indicative conditionals",
    "type": "chapter"
  },
  {
    "author": [
      {
        "family": "Edgington",
        "given": "Dorothy"
      }
    ],
    "container-title": "A Philosophical Companion to First-order Logic",
    "editor": [
      {
        "family": "Hughes",
        "given": "R. I. G."
      }
    ],
    "id": "edgington:do",
    "issued": {
      "date-parts": [
        [
          1993
        ]
      ]
    },
    "page": "28-49",
    "publisher": "Hackett",
    "publisher-place": "Indianapolis",
    "title": "Do conditionals have truth-conditions?",
    "type": "chapter"
  },
  {
    "author": [
      {
        "family": "Edgington",
        "given": "Dorothy"
      }
    ],
    "container-title": "Vagueness: A reader",
    "editor": [
      {
        "family": "Keefe",
        "given": "Rosanna"
      },
      {
        "family": "Smith",
        "given": "Peter"
      }
    ],
    "id": "edgington:vagueness",
    "issued": {
      "date-parts": [
        [
          1997
        ]
      ]
    },
    "page": "294-316",
    "publisher": "MIT",
    "publisher-place": "Cambridge, MA",
    "title": "Vagueness by degrees",
    "type": "chapter"
  },
  {
    "author": [
      {
        "family": "Etchemendy",
        "given": "John"
      }
    ],
    "id": "etchemendy:concept",
    "issued": {
      "date-parts": [
        [
          1990
        ]
      ]
    },
    "publisher": "Harvard University Press",
    "publisher-place": "Cambridge, MA",
    "title": "The concept of logical consequence",
    "type": "book"
  },
  {
    "author": [
      {
        "family": "Etchemendy",
        "given": "John"
      }
    ],
    "container-title": "New Essays on Tarski and Philosophy",
    "editor": [
      {
        "family": "Patterson",
        "given": "Douglas"
      }
    ],
    "id": "etchemendy:reflections",
    "issued": {
      "date-parts": [
        [
          2008
        ]
      ]
    },
    "publisher": "Oxford University Press",
    "publisher-place": "Oxford",
    "title": "Reflections on consequence",
    "type": "chapter"
  }
]</div>
  </div>

  <div class="item">
  <label for="citations">Citations<br></label>
  <div id="citations" class="editor">[
  [ {"id":"diaz2013"},
    {"prefix":"see also ",
     "id":"diaz2016",
     "locator":251,
     "label": "page"},
    {"id":"diaz2015"}
  ],
  [ {"id":"etchemendy:concept"}
  ]
]</div>
  </div>
  </div>

  <div id="result">
  </div>

  <script>
    var style = ace.edit("style", { mode: "ace/mode/xml" });
    var editorOpts = {showLineNumbers: false,
                      showFoldWidgets: true,
                      showGutter: false,
                      theme: "ace/theme/textmate" };
    style.setOptions(editorOpts);

    var references = ace.edit("references", { mode: "ace/mode/json" });
    references.setOptions(editorOpts);

    var abbreviations = ace.edit("abbreviations", { mode: "ace/mode/json" });
    abbreviations.setOptions(editorOpts);

    var citations = ace.edit("citations", { mode: "ace/mode/json" });
    citations.setOptions(editorOpts);

    function renderedCitations(data) {
      var result = document.getElementById("result");
      result.innerHTML = "";
      for (var i=0; i < data.warnings.length; i++) {
        result.innerHTML +=
          "<div class=\"warning\">" + data.warnings[i] + "</div>\n";
      }
      for (var i=0; i < data.citations.length; i++) {
        result.innerHTML +=
          "<p>" + data.citations[i] + "</p>\n";
      }
      var classes = ["csl-bibliography"];
      switch (data['entry-spacing']) {
          case 1: classes.push("entry-spacing-1"); break;
          case 2: classes.push("entry-spacing-2"); break;
          default:
      }
      switch (data['line-spacing']) {
          case 2:  classes.push("line-spacing-2"); break;
          default:
      }
      if (data['hanging-ident']) {
        classes.push("hanging");
      }
      var bib = "";
      bib += "<hr>\n";
      bib += "<div class=\"" + classes.join(" ") + "\">\n"
      for (var i=0; i < data.bibliography.length; i++) {
        bib +=
          "<div id=\"ref-" + data.bibliography[i][0] +
          "\" class=\"csl-entry\">\n" + data.bibliography[i][1] +
          "\n</div>\n";
      }
      bib += "</div>\n";
      result.innerHTML += bib;
    }

    function loadStyle() {
      var styleName = document.getElementById("style-name").value;
      fetch('/style?name=' + styleName, {
        headers: { "Content-Type": "text/plain" },
        method: 'GET'
      })
       .then(function(response) {
            if (!response.ok) {
              throw Error(response.statusText);
            }
            return response.text()
        })
        .catch(error => console.log(error))
        .then(function(data) {
            style.setValue(data);
            style.clearSelection();
            citeproc();
        })
    }

    function getStyleNames() {
      fetch('/styleNames', {
        headers: { "Content-Type": "application/json" },
        method: 'GET'
      })
       .then(function(response) {
            if (!response.ok) {
              throw Error(response.statusText);
            }
            return response.json()
        })
        .catch(error => console.log(error))
        .then(function(data) {
            var styleName = document.getElementById("style-name");
            var opts = [];
            for (var i=0; i < data.length; i++) {
              opts.push("<option value=\"" + data[i] + "\"" +
                ">" + data[i].slice(0,60) + "</option>");
            }
          styleName.innerHTML = opts.join();
          loadStyle();
        })
    }

    function citeproc() {
      var cites = [];
      var citesVal = citations.getValue().trim();
      if (citesVal.length > 0) {
        try {
          cites =
            JSON.parse(citesVal);
        } catch(err) {
          alert(err);
        };
      }


      var lang;
      var langVal = document.getElementById("lang").value.trim();

      var abbrevs = {};
      var abbrevsVal = abbreviations.getValue().trim();
      if (abbrevsVal.length > 0) {
        try {
          abbrevs =
            JSON.parse(abbrevsVal);
        } catch(err) {
          alert(err);
        };
      }

      var refs = [];
      var refsVal = references.getValue().trim();
      if (refsVal.length > 0) {
        try {
          refs =
            JSON.parse(refsVal);
        } catch(err) {
          alert(err);
        };
      }

      if (langVal != "(style default)") {
        lang = langVal;
      }

      fetch('/citeproc', {
        headers: { "Content-Type": "application/json" },
        method: 'POST',
        body: JSON.stringify({
          style: style.getValue(), // document.getElementById("style").value.trim(),
          abbreviations: abbrevs,
          lang: lang,
          references: refs,
          citations: cites,
        }) })
        .then(function(response) {
            if (!response.ok) {
              throw Error(response.statusText);
            }
            return response.json()
        })
        .catch(error => console.log(error))
        .then(data => renderedCitations(data))
      }

    function initialize() {
      getStyleNames();
    }
  </script>


</body>
</html>
